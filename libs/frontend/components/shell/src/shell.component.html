<div class="flex flex-col min-h-screen bg-emphasis text-color">
  <!-- Floating Toolbar -->
  <div class="fixed top-4 left-1/2 transform -translate-x-1/2 z-50 w-full max-w-screen-2xl px-6 floating-toolbar">
    <p-toolbar>
      <ng-template #start>
        <div class="flex items-center space-x-4">
          <h1 class="text-xl font-bold text-color cursor-pointer" [routerLink]="['/']">Badman</h1>

          @if (isDesktop) {
            <!-- Desktop Navigation Links -->
            <nav class="flex items-center space-x-2">
              @if (user()?.slug) {
                <p-button [label]="'all.players.my-profile' | translate" [routerLink]="['/player', user()?.slug]" [text]="true" size="small" />
                @if (clubs().length === 1) {
                  <p-button [label]="'all.players.my-club' | translate" [routerLink]="['/club', clubs()[0].club.slug]" [text]="true" size="small" />
                }
              }
            </nav>
          } @else {
            <!-- Mobile Menu Button -->
            <p-button icon="pi pi-bars" (click)="toggleSidebar()" [outlined]="true" [rounded]="true" size="small" aria-label="Toggle sidebar" />
          }
        </div>
      </ng-template>

      <ng-template #center>
          <app-search />
      </ng-template>

      <ng-template #end>
        <div class="flex items-center space-x-2">
          @if (user()?.firstName) {
            <p-menu #menu [model]="userMenuItems()" [popup]="true" appendTo="body" />
            @if (isDesktop) {
              <p-button [label]="user()?.firstName" [outlined]="true" (click)="menu.toggle($event)" aria-label="User menu" />
            } @else {
              <p-button icon="pi pi-user" [outlined]="true" [rounded]="true" (click)="menu.toggle($event)" aria-label="User menu" />
            }
          } @else {
            <p-button label="Log in" [outlined]="true" (click)="login()" />
          }
        </div>
      </ng-template>
    </p-toolbar>
  </div>

  <div class="pt-20">
    <!-- Mobile Sidebar Overlay -->
    @if (sidebarVisible && !isDesktop) {
      <div class="fixed inset-0 z-40 mobile-overlay" (click)="sidebarVisible = false"></div>
      <aside
        class="fixed left-0 top-0 w-64 shadow-md p-4 min-h-screen z-50 transform transition-transform mobile-sidebar"
        [class.translate-x-0]="sidebarVisible"
        [class.-translate-x-full]="!sidebarVisible"
      >
        <nav class="space-y-2 mt-20">
          @if (user()?.slug) {
            <a
              [routerLink]="['/player', user()?.slug]"
              class="block px-4 py-2 text-color hover:bg-emphasis rounded-lg transition-colors"
              (click)="sidebarVisible = false"
            >
              {{ 'all.players.my-profile' | translate }}
            </a>

            @if (clubs().length === 1) {
              <a
                [routerLink]="['/club', clubs()[0].club.slug]"
                class="block px-4 py-2 text-color hover:bg-emphasis rounded-lg transition-colors"
                (click)="sidebarVisible = false"
              >
                {{ 'all.players.my-club' | translate }}
              </a>
            }
            <p-divider />
          }

          <a routerLink="." class="block px-4 py-2 text-color hover:bg-emphasis rounded-lg transition-colors" (click)="sidebarVisible = false">
            Home
          </a>
          <a routerLink="player" class="block px-4 py-2 text-color hover:bg-emphasis rounded-lg transition-colors" (click)="sidebarVisible = false">
            Players
          </a>
          <a routerLink="club" class="block px-4 py-2 text-color hover:bg-emphasis rounded-lg transition-colors" (click)="sidebarVisible = false">
            Clubs
          </a>
          <a
            routerLink="competition"
            class="block px-4 py-2 text-color hover:bg-emphasis rounded-lg transition-colors"
            (click)="sidebarVisible = false"
          >
            Competition
          </a>
        </nav>
      </aside>
    }

    <!-- Main Content -->
    <main class="flex-1 p-6 max-w-8xl mx-auto">
      <router-outlet />
    </main>
  </div>

  <!-- Toast for notifications -->
  <p-toast position="top-right" />
</div>
