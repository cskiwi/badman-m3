@if (isBrowser()) {
  <p-table
    [value]="dataSource()"
    [loading]="loading()"
    [sortField]="'winRate'"
    [sortOrder]="-1"
    styleClass="p-datatable-sm"
    [paginator]="true"
    [rows]="pageSize"
    [first]="(page-1)*pageSize"
    [totalRecords]="total"
    (onPage)="onPageChange($event)"
    >
    <ng-template pTemplate="header">
      <tr>
        @for (col of columns; track col) {
          <th [pSortableColumn]="col.field">
            {{ col.header | async }}
            <p-sortIcon [field]="col.field"></p-sortIcon>
          </th>
        }
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-rowData>
      <tr>
        @for (col of columns; track col) {
          <td>
            @switch (col.field) {
              @case ('player.fullName') {
                <span>{{ rowData.player?.fullName }}</span>
              }
              @default {
                <span>{{ rowData[col.field] }}</span>
              }
            }
          </td>
        }
      </tr>
    </ng-template>
  </p-table>
} @else {
  <!-- SSR fallback -->
  <div class="p-4 text-center">
    <i class="pi pi-spin pi-spinner text-2xl"></i>
    <p class="mt-2">Loading table...</p>
  </div>
}
