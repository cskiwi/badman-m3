@if (!loading()) {
  @if (this.tournament(); as tournament) {
    <app-page-header>
      <i avatar class="pi pi-pencil text-2xl"></i>
      <span title>{{ 'all.tournament.edit.title' | translate }} - {{ tournament.name }}</span>
      <ng-container subTitle>
        <span>{{ 'all.tournament.edit.subtitle' | translate }}</span>
      </ng-container>
      <ng-container actions>
        <div class="flex gap-3">
          <p-button
            [label]="'all.tournament.edit.actions.save-all' | translate"
            icon="pi pi-save"
            (click)="saveAll()"
            [disabled]="!hasUnsavedChanges"
            [loading]="false"
          />
          <p-button
            [label]="'all.tournament.edit.actions.save-current' | translate"
            icon="pi pi-check"
            [outlined]="true"
            (click)="saveCurrentTab()"
            [disabled]="false"
            [loading]="false"
          />
          <p-button
            [label]="'all.tournament.edit.actions.cancel' | translate"
            icon="pi pi-times"
            severity="secondary"
            [outlined]="true"
            (click)="cancel()"
          />
        </div>
      </ng-container>
    </app-page-header>

    <div class="p-4">
      @if (hasUnsavedChanges) {
        <div class="mb-4 p-3 bg-orange-50 border border-orange-200 rounded-lg">
          <div class="flex items-center gap-2 text-orange-800">
            <i class="pi pi-exclamation-triangle"></i>
            <span class="font-medium">{{ 'all.tournament.edit.messages.unsaved-changes' | translate }}</span>
          </div>
        </div>
      }

      <p-tabs [value]="activeTabIndex()" (activeIndexChange)="onActiveIndexChange($event)">
        <p-tablist>
          <p-tab value="0">
            <i class="pi pi-info-circle mr-2"></i>
            {{ 'all.tournament.edit.tabs.info' | translate }}
          </p-tab>
          <p-tab value="1">
            <i class="pi pi-cog mr-2"></i>
            {{ 'all.tournament.edit.tabs.settings' | translate }}
          </p-tab>
        </p-tablist>

        <p-tabpanels>
          <p-tabpanel value="0">
            <app-tournament-info [tournament]="tournament" />
          </p-tabpanel>

          <p-tabpanel value="1">
            <app-tournament-settings [tournament]="tournament" />
          </p-tabpanel>
        </p-tabpanels>
      </p-tabs>
    </div>
  }
} @else {
  <div class="p-4">
    <p-progressBar mode="indeterminate" [style]="{ height: '6px' }" />
    <p class="text-center text-surface-500 mt-4">{{ 'all.tournament.edit.messages.loading' | translate }}</p>
  </div>
}

@if (error(); as errorMessage) {
  <div class="flex items-center justify-center p-8 text-red-600">
    <i class="pi pi-exclamation-triangle mr-2"></i>
    <span>{{ errorMessage }}</span>
  </div>
}

<p-toast position="top-right" />
